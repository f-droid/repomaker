{% extends "../base.html" %}
{% load i18n %}
{% load humanize %}

{% block title %}{{ app.name }}{% endblock %}
{% block toolbar-title %}<a href="{% url 'repo' app.repo.id %}">{{ app.repo.name }}</a>{% endblock %}

{% block rm-content %}

<div class="mdc-layout-grid">

	<div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6">

		<h1><img src="{{ app.icon.url }}"/> {{ app.name }}</h1>

		{% if app.summary %}
		<h3>{{ app.summary }}</h3>
		{% endif %}

		<ul class="mdc-list mdc-list--dense">
			<li class="mdc-list-item">
				<i class="mdc-list-item__start-detail material-icons">info_outline</i>
				{% blocktrans with package_id=app.package_id %}Package ID: {{ package_id }}{% endblocktrans %}
			</li>
			<li class="mdc-list-item">
				<i class="mdc-list-item__start-detail material-icons">style</i>
					{% if app.category.exists %}
					{% blocktrans with category=app.category.all|join:", "%}Categories: {{ category }}{% endblocktrans %}
					{% else %}
					{% blocktrans with category=app.category.all|join:", "%}Categories: {{ category }}{% endblocktrans %}
					{% endif %}
			</li>
			{% if app.website %}
			<li class="mdc-list-item">
				<i class="mdc-list-item__start-detail material-icons">insert_link</i>
				{% blocktrans with website=app.website|urlize %}Website: {{ website }}{% endblocktrans %}
			</li>
			{% endif %}
			{% if app.description %}
			<li class="mdc-list-item" style="overflow: auto;">
				<i class="mdc-list-item__start-detail material-icons">description</i>
				{% blocktrans with description=app.description %}Description: {{ description }}{% endblocktrans %}
			</li>
			{% endif %}
			<li class="mdc-list-item">
				<i class="mdc-list-item__start-detail material-icons">translate</i>
				{% trans 'Translations:' %}
				{% for lang in app.get_available_languages %}
				{{ lang|language_name }}{% if not forloop.last %}, {% endif %}
				{% empty %}
				<i>{% trans 'None' %}</i>
				{% endfor %}
				<a href="{% url 'app_translate' app.repo.id app.id %}" class="material-icons mdc-ripple-surface" style="padding: 0.5em;">edit</a>
			</li>
			{% if apks %}
			<li class="mdc-list-item">
				<i class="mdc-list-item__start-detail material-icons">gesture</i>
				{% blocktrans with signature=apks.0.apk.signature %}Signature: {{ signature }}{% endblocktrans %}
			</li>
			{% endif %}
			<li class="mdc-list-item">
				<i class="mdc-list-item__start-detail material-icons">watch_later</i>
				{% blocktrans with date=app.added_date|date:"SHORT_DATE_FORMAT" %}Added: {{ date }}{% endblocktrans %}
			</li>
			<li class="mdc-list-item">
				<i class="mdc-list-item__start-detail material-icons">update</i>
				{% blocktrans with date_1=app.last_updated_date|naturaltime date_2=app.last_updated_date|date:"SHORT_DATE_FORMAT" %}Last Updated: {{ date_1 }} ({{ date_2 }}){% endblocktrans %}
			</li>
		</ul>

		<p>
			<a href="{% url 'edit_app' app.repo.id app.id %}" class="rm-no-underline">
				<button class="mdc-button mdc-button--primary mdc-button--raised">
					<i class="material-icons">edit</i>
					{% trans 'Edit App Details' %}
				</button>
			</a>

			<a href="{% url 'screenshot_add' app.repo.id app.id %}" class="rm-no-underline">
				<button class="mdc-button mdc-button--primary mdc-button--raised">
					<i class="material-icons">add</i>
					{% trans 'Add Screenshot' %}
				</button>
			</a>

			<a href="{% url 'delete_app' app.repo.id app.id %}" class="rm-no-underline">
				<button class="mdc-button mdc-button--raised">
					<i class="material-icons">delete</i>
					{% trans 'Delete App' %}
				</button>
			</a>
		</p>

	</div>

	<div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6">

		<h2>{% trans 'Versions' %}</h2>

		{% if apks %}
		<ul class="mdc-list">
			{% for pointer in apks %}
			<li><h4>{{ pointer.apk.version_name }} <span style="font-weight: normal; font-size: 75%;">({{ pointer.apk.version_code }})</span></h4>
				{% if pointer.file %}
				<ul class="mdc-list mdc-list--dense">
					<li class="mdc-list-item">
						{% blocktrans with size=pointer.apk.size|filesizeformat %}Size: {{ size }}{% endblocktrans %}
					</li>
					<li class="mdc-list-item">
						{% blocktrans with file=pointer.file.name %}File: {{ file }}{% endblocktrans %}
					</li>
					<li class="mdc-list-item">
						{% blocktrans with hash_type=pointer.apk.hash_type hash=pointer.apk.hash %}Hash ({{ hash_type }}): {{ hash }}{% endblocktrans %}
					</li>
				</ul>
				{% else %}
				<em>{% trans 'APK is still downloading...' %}</em>
				{% endif %}
			</li>
			{% endfor %}
		</ul>
		{% endif %}

		<div style="text-align: right; margin: 2em;">
			<a href="{% url 'add_app' app.repo.id %}" class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12 rm-no-underline">
				<button class="mdc-fab material-icons">
					<span class="mdc-fab__icon">add</span>
				</button>
			</a>
		</div>

	</div>

	<div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12"
		 style="display: block; white-space: nowrap; overflow: auto; margin-right: 10px; margin-bottom: 10px; padding: 10px">
		{% for screenshot in app.screenshot_set.all %}
		<img src="{{ screenshot.get_url }}" style="display: inline-block; margin: 10px 0px 10px 10px; max-height:500px"/>
		<a href="{% url 'screenshot_delete' app.repo.id app.id screenshot.id %}" class="rm-no-underline"
		   style="position: relative; left: -25px;">
			<button class="mdc-fab mdc-fab--mini material-icons">
				<span class="mdc-fab__icon">delete</span>
			</button>
		</a>
		{% endfor %}
	</div>

</div>

{% endblock rm-content %}
